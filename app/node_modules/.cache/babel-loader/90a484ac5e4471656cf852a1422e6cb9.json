{"ast":null,"code":"import { all, put, takeEvery, call } from 'redux-saga/effects';\nimport { spotifyApi } from '../../api';\n\nfunction* getAlbuns(action) {\n  const {\n    token\n  } = action.payload;\n  const config = {\n    headers: {\n      Authorization: token\n    }\n  };\n  const response = yield call(spotifyApi.get, '/recommendations?seed_genres=metal', config);\n  const albuns = response.data.tracks.map(x => {\n    return {\n      name: x.album.name,\n      images: x.album.images,\n      id: x.album.id,\n      link: x.album.href,\n      artist: x.album.artists[0].name\n    };\n  }); //  console.log(response.data.tracks[0].artists[0].id)\n  //   let artists: any = [];\n  //   const x  = response.data.tracks.map( async (x:Itracks) => {\n  //     const res: { data: string } =  await spotifyApi.get(\n  //         `/artists/${x.artists[0].id}`,\n  //         config)\n  //        artists = [...artists, res.data]\n  //     return res.data\n  //   })\n  //   console.log(artists)\n\n  yield put({\n    type: \"@spotify/GET_ARTISTS\",\n    payload: {\n      data: response.data.tracks\n    }\n  });\n  yield put({\n    type: \"spotify/GET_ALBUNS\",\n    payload: {\n      albuns\n    }\n  });\n}\n\nfunction* getArtists(action) {\n  const {\n    tracks\n  } = action.payload;\n  yield console.log(tracks);\n}\n\nexport default function* spotifySaga() {\n  yield all([takeEvery(\"@spotify/GET_ALBUNS\", getAlbuns), takeEvery(\"@spotify/GET_ARTISTS\", getArtists)]);\n}","map":{"version":3,"sources":["/home/reis/Documentos/programacao/react/metal-spotify/app/src/store/spotify/saga.ts"],"names":["all","put","takeEvery","call","spotifyApi","getAlbuns","action","token","payload","config","headers","Authorization","response","get","albuns","data","tracks","map","x","name","album","images","id","link","href","artist","artists","type","getArtists","console","log","spotifySaga"],"mappings":"AACA,SAASA,GAAT,EAAcC,GAAd,EAAmBC,SAAnB,EAA8BC,IAA9B,QAA+C,oBAA/C;AAEA,SAASC,UAAT,QAA2B,WAA3B;;AA4BE,UAAUC,SAAV,CAAoBC,MAApB,EAAsC;AAEpC,QAAM;AAAEC,IAAAA;AAAF,MAAYD,MAAM,CAACE,OAAzB;AAEA,QAAMC,MAAM,GAAG;AACXC,IAAAA,OAAO,EAAE;AAACC,MAAAA,aAAa,EAAEJ;AAAhB;AADE,GAAf;AAGA,QAAMK,QAAmB,GAAG,MAAMT,IAAI,CAACC,UAAU,CAACS,GAAZ,EAClC,oCADkC,EAElCJ,MAFkC,CAAtC;AAKE,QAAMK,MAAM,GAAGF,QAAQ,CAACG,IAAT,CAAcC,MAAd,CAAqBC,GAArB,CAA0BC,CAAD,IAAa;AACjD,WAAO;AACHC,MAAAA,IAAI,EAAED,CAAC,CAACE,KAAF,CAAQD,IADX;AAEHE,MAAAA,MAAM,EAAEH,CAAC,CAACE,KAAF,CAAQC,MAFb;AAGHC,MAAAA,EAAE,EAAEJ,CAAC,CAACE,KAAF,CAAQE,EAHT;AAIHC,MAAAA,IAAI,EAAEL,CAAC,CAACE,KAAF,CAAQI,IAJX;AAKHC,MAAAA,MAAM,EAAEP,CAAC,CAACE,KAAF,CAAQM,OAAR,CAAgB,CAAhB,EAAmBP;AALxB,KAAP;AAQH,GATc,CAAf,CAZkC,CAuBpC;AAEA;AACA;AAEA;AACA;AACA;AAGA;AAEA;AACA;AAEA;;AAGA,QAAMlB,GAAG,CAAC;AAAC0B,IAAAA,IAAI,EAAE,sBAAP;AAA+BnB,IAAAA,OAAO,EAAE;AAACO,MAAAA,IAAI,EAAEH,QAAQ,CAACG,IAAT,CAAcC;AAArB;AAAxC,GAAD,CAAT;AACA,QAAMf,GAAG,CAAC;AAAC0B,IAAAA,IAAI,EAAE,oBAAP;AAA6BnB,IAAAA,OAAO,EAAE;AAAEM,MAAAA;AAAF;AAAtC,GAAD,CAAT;AAGH;;AAGD,UAAUc,UAAV,CAAqBtB,MAArB,EAAuC;AAEnC,QAAM;AAAEU,IAAAA;AAAF,MAAcV,MAAM,CAACE,OAA3B;AAEA,QAAMqB,OAAO,CAACC,GAAR,CAAYd,MAAZ,CAAN;AACH;;AAGD,eAAe,UAAUe,WAAV,GAAuB;AAClC,QAAM/B,GAAG,CAAC,CACNE,SAAS,CAAC,qBAAD,EAAwBG,SAAxB,CADH,EAENH,SAAS,CAAC,sBAAD,EAAyB0B,UAAzB,CAFH,CAAD,CAAT;AAIH","sourcesContent":["import { AnyAction } from '@reduxjs/toolkit'\nimport { all, put, takeEvery, call, take} from 'redux-saga/effects'\n\nimport { spotifyApi } from '../../api'\n\n\ninterface Iimages {\n    url: string;\n}\ninterface Itracks {\n    album: {\n        name:string;\n        href:string;\n        images: Iimages[];\n        id: string;\n        artists: [{\n            name:string;\n        }]\n    }\n\n    artists: [{\n        id:string\n    }]\n}\ninterface IResponse {\n    data: {\n       tracks: Itracks[]\n    }\n}\n\n\n  function* getAlbuns(action: AnyAction){\n\n    const { token } = action.payload;\n\n    const config = {\n        headers: {Authorization: token }\n    }\n    const response: IResponse = yield call(spotifyApi.get,\n        '/recommendations?seed_genres=metal',\n        config\n        )\n\n      const albuns = response.data.tracks.map((x:Itracks)=>{\n          return {\n              name: x.album.name,\n              images: x.album.images,\n              id: x.album.id,\n              link: x.album.href,\n              artist: x.album.artists[0].name\n\n          }\n      })  \n\n    //  console.log(response.data.tracks[0].artists[0].id)\n\n    //   let artists: any = [];\n    //   const x  = response.data.tracks.map( async (x:Itracks) => {\n\n    //     const res: { data: string } =  await spotifyApi.get(\n    //         `/artists/${x.artists[0].id}`,\n    //         config)\n\n          \n    //        artists = [...artists, res.data]\n\n    //     return res.data\n    //   })\n\n    //   console.log(artists)\n\n\n    yield put({type: \"@spotify/GET_ARTISTS\", payload: {data: response.data.tracks} })\n    yield put({type: \"spotify/GET_ALBUNS\", payload: { albuns}})\n\n\n}\n\n\nfunction* getArtists(action: AnyAction){\n\n    const { tracks  } = action.payload\n\n    yield console.log(tracks)\n}\n\n\nexport default function* spotifySaga(){\n    yield all([\n        takeEvery(\"@spotify/GET_ALBUNS\", getAlbuns),\n        takeEvery(\"@spotify/GET_ARTISTS\", getArtists)       \n    ])\n}\n"]},"metadata":{},"sourceType":"module"}